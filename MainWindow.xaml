<Window x:Class="DollOverlay.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DollOverlay"
        mc:Ignorable="d"
        Title="Table Overlay"
        AllowsTransparency="True"
        WindowStyle="None"
        Topmost="True"
        Icon="images/favicon.ico"
        ShowInTaskbar="False"
        MinWidth="250"
        MinHeight="300"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        MouseEnter="MainFrame_MouseEnter"
        MouseLeave="MainFrame_MouseLeave"
        WindowStartupLocation="Manual"
        KeyDown="Window_KeyDown"
        >

        <WindowChrome.WindowChrome>
                <WindowChrome ResizeBorderThickness="8"
                              CaptionHeight="0"
                              CornerRadius="0"
                              GlassFrameThickness="0"/>
        </WindowChrome.WindowChrome>
        <Window.Resources>
                <local:OpacityToVisibilityConverter x:Key="OpacityToVisibilityConverter"/>
            
        <Style x:Key="BaseTextBoxStyle" TargetType="TextBox">
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontSize" Value="14"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Padding" Value="5,2,5,2"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TextBox">
                                <Grid SnapsToDevicePixels="True">
                                        <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="3"/>  
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="3"/>  
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                                <RowDefinition Height="3"/>   
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="3"/>   
                                        </Grid.RowDefinitions>


                                    <Image Grid.Row="0" Grid.Column="0" Source="images/input-TL.png" Stretch="None"/>
                                    <Image Grid.Row="0" Grid.Column="2" Source="images/input-TR.png" Stretch="None"/>
                                    
                                    <Border Grid.Row="1" Grid.Column="1" Margin="0">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-C.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,10,10" Stretch="None"/>
                                        </Border.Background>
                                        <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center" Margin="2,0"/>
                                    </Border>
                                    <Border Grid.Row="0" Grid.Column="1">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-T.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,10,3" Stretch="None"/> </Border.Background>
                                        </Border>

                                        <Border Grid.Row="1" Grid.Column="0">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-L.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,3,10" Stretch="None"/> </Border.Background>
                                        </Border>

                                        <Border Grid.Row="1" Grid.Column="2">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-R.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,3,10" Stretch="None"/> </Border.Background>
                                        </Border>

                                        <Border Grid.Row="2" Grid.Column="1">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-B.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,10,3" Stretch="None"/> </Border.Background>
                                        </Border>

                                    <Image Grid.Row="2" Grid.Column="2" Source="images/input-BR.png" Stretch="None"/>
                                    <Image Grid.Row="2" Grid.Column="0" Source="images/input-BL.png" Stretch="None"/>

                                        <Border x:Name="FocusGlow"
                                        CornerRadius="5"
                                        Opacity="0">
                                <Border.Effect>
                                        <DropShadowEffect Color="#FFFF00" 
                                                        ShadowDepth="0" 
                                                        BlurRadius="10" 
                                                        RenderingBias="Quality"/>
                                </Border.Effect>
                                </Border>
                                
                                </Grid>
                                                                        
                                <ControlTemplate.Triggers>
                                        <Trigger Property="IsKeyboardFocusWithin" Value="True">
                                        <Setter TargetName="FocusGlow" Property="Opacity" Value="1"/>
                                        </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>

                <Style x:Key="PasswordBox" TargetType="PasswordBox">
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontSize" Value="14"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Padding" Value="5,2,5,2"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="PasswordBox">
                                <Grid SnapsToDevicePixels="True">
                                        <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="3"/>  
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="3"/>  
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                                <RowDefinition Height="3"/>   
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="3"/>   
                                        </Grid.RowDefinitions>

                                    <Image Grid.Row="0" Grid.Column="0" Source="images/input-TL.png" Stretch="None"/>
                                    <Image Grid.Row="0" Grid.Column="2" Source="images/input-TR.png" Stretch="None"/>
                                    
                                    <Border Grid.Row="1" Grid.Column="1" Margin="0">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-C.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,10,10" Stretch="None"/>
                                        </Border.Background>
                                        <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center" Margin="2,0"/>
                                    </Border>
                                    <Border Grid.Row="0" Grid.Column="1">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-T.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,10,3" Stretch="None"/> </Border.Background>
                                        </Border>

                                        <Border Grid.Row="1" Grid.Column="0">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-L.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,3,10" Stretch="None"/> </Border.Background>
                                        </Border>

                                        <Border Grid.Row="1" Grid.Column="2">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-R.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,3,10" Stretch="None"/> </Border.Background>
                                        </Border>

                                        <Border Grid.Row="2" Grid.Column="1">
                                        <Border.Background>
                                                <ImageBrush ImageSource="images/input-B.png" TileMode="Tile" ViewportUnits="Absolute" 
                                                        Viewport="0,0,10,3" Stretch="None"/> </Border.Background>
                                        </Border>

                                    <Image Grid.Row="2" Grid.Column="2" Source="images/input-BR.png" Stretch="None"/>
                                    <Image Grid.Row="2" Grid.Column="0" Source="images/input-BL.png" Stretch="None"/>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>

<Style x:Key="BaseComboBoxItemStyle" TargetType="ComboBoxItem">
    <Setter Property="Foreground" Value="White"/>
    <Setter Property="Background" Value="Transparent"/>
    <!-- Устанавливаем отступы, чтобы контент элемента был хорошо виден -->
    <Setter Property="Padding" Value="10,4,10,4"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ComboBoxItem">
                <Border x:Name="Border"
                        Background="{TemplateBinding Background}"
                        SnapsToDevicePixels="True">
                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                      Margin="{TemplateBinding Padding}"/>
                </Border>
                <ControlTemplate.Triggers>
                    <!-- СОСТОЯНИЕ: Наведение мыши (Hover) -->
                    <!-- Применяем темно-серый или синий оттенок для подсветки, чтобы он контрастировал с input-C -->
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="#2A3C5B"/>
                    </Trigger>
                    <!-- СОСТОЯНИЕ: Выбранный элемент (Selected) -->
                    <!-- Более насыщенный цвет для выбранного элемента -->
                    <Trigger Property="IsSelected" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="#3F597A"/>
                    </Trigger>
                    <!-- СОСТОЯНИЕ: Отключенный элемент (Disabled) -->
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Foreground" Value="#777777"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<Style x:Key="BaseComboBoxStyle" TargetType="ComboBox">
    <Setter Property="Foreground" Value="White"/>
    <Setter Property="FontSize" Value="14"/>
    <Setter Property="Height" Value="30"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="Background" Value="Transparent"/>
    <!-- Применяем наш новый стиль для контейнеров элементов -->
    <Setter Property="ItemContainerStyle" Value="{StaticResource BaseComboBoxItemStyle}"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ComboBox">
                <Grid>
                    <!-- ToggleButton содержит всю 9-patch рамку ComboBox (верхняя часть) -->
                    <ToggleButton x:Name="ToggleButton" 
                                    Grid.Column="2" 
                                    Focusable="false"
                                    IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                    ClickMode="Press">
                        <ToggleButton.Template>
                            <ControlTemplate TargetType="ToggleButton">
                                <Grid SnapsToDevicePixels="True">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3"/> 	<!-- Левый угол (3px) -->
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="3"/> 	<!-- Правый угол (3px) -->
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="3"/> 	<!-- Верхний угол (3px) -->
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="3"/> 	<!-- Нижний угол (3px) -->
                                    </Grid.RowDefinitions>

                                    <!-- 1. Top-Left Corner -->
                                    <Image Grid.Row="0" Grid.Column="0" Source="images/input-TL.png" Stretch="None"/>
                                    
                                    <!-- 2. Top Border: Viewport Height 3px -->
                                    <Border Grid.Row="0" Grid.Column="1">
                                        <Border.Background>
                                            <ImageBrush ImageSource="images/input-T.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,10,3" Stretch="None"/>
                                        </Border.Background>
                                    </Border>
                                    
                                    <!-- 3. Top-Right Corner -->
                                    <Image Grid.Row="0" Grid.Column="2" Source="images/input-TR.png" Stretch="None"/>

                                    <!-- 4. Left Border: Viewport Width 3px -->
                                    <Border Grid.Row="1" Grid.Column="0">
                                        <Border.Background>
                                            <ImageBrush ImageSource="images/input-L.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,3,10" Stretch="None"/>
                                        </Border.Background>
                                    </Border>
                                    
                                    <!-- 5. Center Background (input-C) -->
                                    <Border Grid.Row="1" Grid.Column="1">
                                        <Border.Background>
                                            <ImageBrush ImageSource="images/input-C.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,10,10" Stretch="None"/>
                                        </Border.Background>
                                    </Border>
                                    
                                    <!-- 6. Right Border: Viewport Width 3px -->
                                    <Border Grid.Row="1" Grid.Column="2">
                                        <Border.Background>
                                            <ImageBrush ImageSource="images/input-R.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,3,10" Stretch="None"/>
                                        </Border.Background>
                                    </Border>

                                    <!-- 7. Bottom-Left Corner -->
                                    <Image Grid.Row="2" Grid.Column="0" Source="images/input-BL.png" Stretch="None"/>
                                    
                                    <!-- 8. Bottom Border: Viewport Height 3px -->
                                    <Border Grid.Row="2" Grid.Column="1">
                                        <Border.Background>
                                            <ImageBrush ImageSource="images/input-B.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,10,3" Stretch="None"/>
                                        </Border.Background>
                                    </Border>
                                    
                                    <!-- 9. Bottom-Right Corner -->
                                    <Image Grid.Row="2" Grid.Column="2" Source="images/input-BR.png" Stretch="None"/>

                                    <!-- Arrow path: positioned correctly in the central cell (1,1) -->
                                    <Path Grid.Column="1" Grid.Row="1" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0"
                                            Fill="White" Data="M 0 0 L 4 4 L 8 0 Z"/>
                                </Grid>
                            </ControlTemplate>
                        </ToggleButton.Template>
                    </ToggleButton>

                    <!-- ContentPresenter (Selected Item Text) -->
                    <ContentPresenter Name="ContentSite"
                                        IsHitTestVisible="False"
                                        Content="{TemplateBinding SelectionBoxItem}"
                                        ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                        ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                        Margin="10,0,25,0"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Left" />

                    <!-- Popup for the drop-down list -->
                    <Popup x:Name="Popup" Placement="Bottom" IsOpen="{Binding IsChecked, ElementName=ToggleButton}" 
                            AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                        <!-- Здесь мы заменяем стандартный DropDownBorder на нашу 9-patch структуру -->
                        <Grid Name="DropDown" SnapsToDevicePixels="True" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="3"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="3"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="3"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="3"/>
                                </Grid.RowDefinitions>

                                <!-- Corners -->
                                <Image Grid.Row="0" Grid.Column="0" Source="images/input-TL.png" Stretch="None"/>
                                <Image Grid.Row="0" Grid.Column="2" Source="images/input-TR.png" Stretch="None"/>
                                <Image Grid.Row="2" Grid.Column="2" Source="images/input-BR.png" Stretch="None"/>
                                <Image Grid.Row="2" Grid.Column="0" Source="images/input-BL.png" Stretch="None"/>

                                <!-- Borders (Viewport 3px thick) -->
                                <Border Grid.Row="0" Grid.Column="1">
                                    <Border.Background>
                                        <ImageBrush ImageSource="images/input-T.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,10,3" Stretch="None"/>
                                    </Border.Background>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="0">
                                    <Border.Background>
                                        <ImageBrush ImageSource="images/input-L.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,3,10" Stretch="None"/>
                                    </Border.Background>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="2">
                                    <Border.Background>
                                        <ImageBrush ImageSource="images/input-R.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,3,10" Stretch="None"/>
                                    </Border.Background>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="1">
                                    <Border.Background>
                                        <ImageBrush ImageSource="images/input-B.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,10,3" Stretch="None"/>
                                    </Border.Background>
                                </Border>

                                <!-- Center Content (ItemsPresenter inside ScrollViewer) -->
                                <Border Grid.Row="1" Grid.Column="1">
                                    <!-- Центр заполняется input-C -->
                                    <Border.Background>
                                        <ImageBrush ImageSource="images/input-C-dark.png" TileMode="Tile" ViewportUnits="Absolute" Viewport="0,0,10,10" Stretch="None"/>
                                    </Border.Background>
                                    <!-- ItemsPresenter с отступами для контента внутри рамки -->
                                    <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True"> 
                                        <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Border>
                            </Grid>
                        </Grid>
                    </Popup>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>


                <Style TargetType="ComboBoxItem">
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="Background"
                                Value="#061B3D"/>

                        <Setter Property="Padding"
                                Value="5"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Style.Triggers>
                                <Trigger Property="IsSelected"
                                         Value="True">
                                        <Setter Property="Background"
                                                Value="#061B3D"/>
                                </Trigger>

                                <Trigger Property="IsMouseOver"
                                         Value="True">
                                        <Setter Property="Background"
                                                Value="#061B3D"/>
                                </Trigger>
                        </Style.Triggers>
                </Style>

                <Style x:Key="BaseTextBlockStyle"
                       TargetType="TextBlock">
                        <Setter Property="Foreground"
                                Value="White"/>

                        <Setter Property="Margin"
                                Value="0,5,0,5"/>
                        <Setter Property="FontSize"
                                Value="15"/>
                        <Setter Property="FontWeight"
                                Value="Bold"/>
                </Style>

                <Style TargetType="TextBlock"
                       BasedOn="{StaticResource BaseTextBlockStyle}"/>
                <Style TargetType="TextBox"
                       BasedOn="{StaticResource BaseTextBoxStyle}"/>
                <Style TargetType="ComboBox"
                       BasedOn="{StaticResource BaseComboBoxStyle}"/>


                <!-- <Style TargetType="PasswordBox">
                        <Setter Property="Background"
                                Value="#1f1f1f"/>
                        <Setter Property="BorderBrush"
                                Value="#444"/>
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="Padding"
                                Value="5"/>
                </Style> -->

                <Style x:Key="EditRowWrapper"
                       TargetType="StackPanel">

                        <Setter Property="Orientation"
                                Value="Horizontal"/>
                        <Setter Property="HorizontalAlignment"
                                Value="Stretch"/>
                        <Setter Property="Margin"
                                Value="0,10,0,0"/>
                        <Setter Property="MaxWidth"
                                Value="400"/>
                </Style>

                <Style x:Key="LoginButtonStyle"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="#4CAF50"/>
                        <Setter Property="Foreground"
                                Value="White"/>

                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="10"/>
                        <Setter Property="FontWeight"
                                Value="Bold"/>
                        <Setter Property="FontSize"
                                Value="14"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                </Style>

                <Style x:Key="CancelButtonStyle"
                       TargetType="Button">
                        <Setter Property="Background"
                                Value="#e8776f"/>

                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Padding"
                                Value="10"/>
                        <Setter Property="FontWeight"
                                Value="Bold"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="FontSize"
                                Value="14"/>
                </Style>

                <Style TargetType="Button">

                        <Setter Property="FocusVisualStyle"
                                Value="{x:Null}"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                </Style>

                <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background"
                                Value="Transparent"/>
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="FontWeight"
                                Value="Bold"/>
                        <Setter Property="HorizontalAlignment"
                                Value="Center"/>
                        <Setter Property="Padding"
                                Value="0,5"/>
                </Style>

                <Style TargetType="DataGridCell">
                        <Setter Property="Padding"
                                Value="5,0"/>
                        <Setter Property="HorizontalAlignment"
                                Value="Center"/>
                </Style>

                <Style TargetType="DataGrid">
                        <Setter Property="Padding"
                                Value="0"/>
                        <Setter Property="Background"
                                Value="Transparent"/>
                        <Setter Property="BorderBrush"
                                Value="Transparent"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                </Style>


                <SolidColorBrush x:Key="ScrollBarTrackBrush"
                                 Color="Transparent"/>
                <SolidColorBrush x:Key="ScrollBarThumbNormalBrush"
                                 Color="#5a5a5a"/>
                <SolidColorBrush x:Key="ScrollBarThumbHoverBrush"
                                 Color="#888888"/>
                <SolidColorBrush x:Key="ScrollBarThumbPressedBrush"
                                 Color="#a0a0a0"/>
                <SolidColorBrush x:Key="ScrollBarButtonBrush"
                                 Color="Transparent"/>

                <Style x:Key="ScrollBarThumbStyle"
                       TargetType="{x:Type Thumb}">
                        <Setter Property="OverridesDefaultStyle"
                                Value="true"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Setter Property="IsTabStop"
                                Value="false"/>

                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                                <Border x:Name="border"
                                                        Background="{StaticResource ScrollBarThumbNormalBrush}"
                                                        CornerRadius="4"
                                                        SnapsToDevicePixels="True"/>
                                                <ControlTemplate.Triggers>

                                                        <Trigger Property="IsMouseOver"
                                                                 Value="true">
                                                                <Setter TargetName="border"
                                                                        Property="Background"
                                                                        Value="{StaticResource ScrollBarThumbHoverBrush}"/>
                                                        </Trigger>

                                                        <Trigger Property="IsDragging"
                                                                 Value="true">
                                                                <Setter TargetName="border"
                                                                        Property="Background"
                                                                        Value="{StaticResource ScrollBarThumbPressedBrush}"/>
                                                        </Trigger>

                                                </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <Style x:Key="ScrollBarPageButton"
                       TargetType="{x:Type RepeatButton}">
                        <Setter Property="OverridesDefaultStyle"
                                Value="true"/>
                        <Setter Property="Background"
                                Value="Transparent"/>

                        <Setter Property="IsTabStop"
                                Value="false"/>
                        <Setter Property="Focusable"
                                Value="false"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type RepeatButton}">

                                                <Border Background="Transparent"/>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <ControlTemplate x:Key="VerticalScrollBarTemplate"
                                 TargetType="{x:Type ScrollBar}">
                        <Grid>
                                <Grid.RowDefinitions>

                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Border Grid.RowSpan="3"
                                        Background="{StaticResource ScrollBarTrackBrush}"
                                        CornerRadius="4"/>
                                <Track x:Name="PART_Track"
                                       Grid.Row="1"
                                       IsDirectionReversed="true">
                                        <Track.DecreaseRepeatButton>

                                                <RepeatButton Style="{StaticResource ScrollBarPageButton}"/>
                                        </Track.DecreaseRepeatButton>
                                        <Track.Thumb>
                                                <Thumb Style="{StaticResource ScrollBarThumbStyle}"
                                                       Margin="1"/>
                                        </Track.Thumb>

                                        <Track.IncreaseRepeatButton>
                                                <RepeatButton Style="{StaticResource ScrollBarPageButton}"/>
                                        </Track.IncreaseRepeatButton>
                                </Track>
                        </Grid>
                </ControlTemplate>


                <Style x:Key="{x:Type ScrollBar}"
                       TargetType="{x:Type ScrollBar}">
                        <Setter Property="OverridesDefaultStyle"
                                Value="true"/>
                        <Style.Triggers>
                                <Trigger Property="Orientation"
                                         Value="Vertical">
                                        <Setter Property="Width"
                                                Value="3"/>
                                        <Setter Property="Template"
                                                Value="{StaticResource VerticalScrollBarTemplate}"/>

                                </Trigger>
                                <Trigger Property="Orientation"
                                         Value="Horizontal">
                                        <Setter Property="Height"
                                                Value="3"/>
                                </Trigger>
                        </Style.Triggers>
                </Style>

                <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

                <local:InvertedBooleanToVisibilityConverter x:Key="InvertedBooleanToVisibilityConverter"/>
                <local:WhiteTimeColorConverter x:Key="WhiteTimeColorConverter"/>
                <Style x:Key="TitleStyle"
                       TargetType="TextBlock">
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="FontSize"
                                Value="24"/>
                        <Setter Property="FontWeight"
                                Value="Bold"/>
                        <Setter Property="HorizontalAlignment"
                                Value="Center"/>
                </Style>


                <Storyboard x:Key="LoadingAnimation"
                            RepeatBehavior="Forever">
                        <ColorAnimation Storyboard.TargetName="Dot1"
                                        Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)"
                                        To="#A9B8D5"
                                        From="#415B91"
                                        Duration="0:0:1.5"
                                        AutoReverse="True"/>

                        <ColorAnimation Storyboard.TargetName="Dot2"
                                        Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)"
                                        To="#7589B3"
                                        From="#415B91"
                                        BeginTime="0:0:0.25"
                                        Duration="0:0:1.5"
                                        AutoReverse="True"/>

                        <ColorAnimation Storyboard.TargetName="Dot3"
                                        Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)"
                                        To="#415B91"
                                        From="#415B91"
                                        BeginTime="0:0:0.5"
                                        Duration="0:0:1.5"
                                        AutoReverse="True"/>
                </Storyboard>
        </Window.Resources>
        <Window.Background>
                <SolidColorBrush Color="Black" Opacity="0.01"/>
        </Window.Background>

        <Grid>
           <Grid x:Name="MainFrame" Opacity="0.0" >
    <!-- 5 колонок -->
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/> <!-- TL / LT / L / LB / BL -->
        <ColumnDefinition Width="*"/>    <!-- TLB (repeat) -->
        <ColumnDefinition Width="Auto"/> <!-- T (fixed) -->
        <ColumnDefinition Width="*"/>    <!-- TRB (repeat) -->
        <ColumnDefinition Width="Auto"/> <!-- TR / RT / R / RB / BR -->
    </Grid.ColumnDefinitions>
    
    <!-- 5 рядов -->
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>   <!-- TL / TLB / T / TRB / TR -->
        <RowDefinition Height="Auto"/>   <!-- LT / RT -->
        <RowDefinition Height="*"/>      <!-- L / C / R (repeat vertical) -->
        <RowDefinition Height="Auto"/>   <!-- LB / RB -->
        <RowDefinition Height="Auto"/>   <!-- BL / BLB / B / BRB / BR -->
    </Grid.RowDefinitions>

    <!-- === ВЕРХНЯЯ ЧАСТЬ (ряд 0) === -->
    <Image Grid.Row="0" Grid.Column="0" Source="images/TL.png" Stretch="None"/>
    
    <!-- TLB - повторяется по горизонтали -->
    <Border Grid.Row="0" Grid.Column="1">
        <Border.Background>
            <ImageBrush ImageSource="images/TLB.png" 
                       TileMode="Tile" 
                       Viewport="0,0,54,32" 
                       ViewportUnits="Absolute"
                       Stretch="None"/>
        </Border.Background>
    </Border>
    
    <Image Grid.Row="0" Grid.Column="2" Source="images/T.png" Stretch="None"/>
    
    <!-- TRB - повторяется по горизонтали -->
    <Border Grid.Row="0" Grid.Column="3">
        <Border.Background>
            <ImageBrush ImageSource="images/TRB.png" 
                       TileMode="Tile" 
                       Viewport="0,0,46,32" 
                       ViewportUnits="Absolute"
                       Stretch="None"/>
        </Border.Background>
    </Border>
    
    <Image Grid.Row="0" Grid.Column="4" Source="images/TR.png" Stretch="None"/>

    <!-- === ЛЕВАЯ ВЕРТИКАЛЬНАЯ ЧАСТЬ === -->
    <Image Grid.Row="1" Grid.Column="0" Source="images/LT.png" Stretch="None"/>
    
    <!-- L - повторяется по вертикали -->
    <Border Grid.Row="2" Grid.Column="0">
        <Border.Background>
            <ImageBrush ImageSource="images/L.png" 
                       TileMode="Tile" 
                       Viewport="0,0,13,19" 
                       ViewportUnits="Absolute"
                       Stretch="None"/>
        </Border.Background>
    </Border>
    
    <Image Grid.Row="3" Grid.Column="0" Source="images/LB.png" Stretch="None"/>

    <!-- === ПРАВАЯ ВЕРТИКАЛЬНАЯ ЧАСТЬ === -->
    <Image Grid.Row="1" Grid.Column="4" Source="images/RT.png" Stretch="None"/>
    
    <!-- R - повторяется по вертикали -->
    <Border Grid.Row="2" Grid.Column="4">
        <Border.Background>
            <ImageBrush ImageSource="images/R.png" 
                       TileMode="Tile" 
                       Viewport="0,0,13,19" 
                       ViewportUnits="Absolute"
                       Stretch="None"/>
        </Border.Background>
    </Border>
    
    <Image Grid.Row="3" Grid.Column="4" Source="images/RB.png" Stretch="None"/>

    <!-- === НИЖНЯЯ ЧАСТЬ (ряд 4) === -->
    <Image Grid.Row="4" Grid.Column="0" Source="images/BL.png" Stretch="None"/>
    
    <!-- BLB - повторяется по горизонтали -->
    <Border Grid.Row="4" Grid.Column="1">
        <Border.Background>
            <ImageBrush ImageSource="images/BLB.png" 
                       TileMode="Tile" 
                       Viewport="0,0,51,14" 
                       ViewportUnits="Absolute"
                       Stretch="None"/>
        </Border.Background>
    </Border>
    
    <Image Grid.Row="4" Grid.Column="2" Source="images/B.png" Stretch="None"/>
    
    <!-- BRB - повторяется по горизонтали -->
    <Border Grid.Row="4" Grid.Column="3">
        <Border.Background>
            <ImageBrush ImageSource="images/BRB.png" 
                       TileMode="Tile" 
                       Viewport="0,0,46,14" 
                       ViewportUnits="Absolute"
                       Stretch="None"/>
        </Border.Background>
    </Border>
    
    <Image Grid.Row="4" Grid.Column="4" Source="images/BR.png" Stretch="None"/>

    <!-- === ЦЕНТРАЛЬНАЯ ЧАСТЬ (повторяется по обеим осям) === -->
    <Border Grid.Row="1" Grid.RowSpan="3" Grid.Column="1" Grid.ColumnSpan="3">
        <Border.Background>
            <ImageBrush ImageSource="images/C.png" 
                       TileMode="Tile" 
                       Viewport="0,0,148,218" 
                       ViewportUnits="Absolute"
                       Stretch="None"/>
        </Border.Background>
    </Border>

    <!-- === КОНТЕНТ === -->    
    <ContentPresenter Grid.Row="1" Grid.RowSpan="3" Grid.Column="1" Grid.ColumnSpan="3" Margin="5"/>
</Grid>
           
                     <Grid>
                <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0"
                        Margin="0"
                        VerticalAlignment="Top">
                        
                        <Grid.Style>
                                <Style TargetType="{x:Type Grid}">
                                <Setter Property="Visibility" Value="Hidden"/>
                                <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=MainFrame, Path=Opacity}" Value="1.0">
                                                <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                        
                                        <DataTrigger Binding="{Binding IsContentCollapsed, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
                                                <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                </Style.Triggers>
                                </Style>
                        </Grid.Style>

                        <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0"
                                        Orientation="Horizontal"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top">
                                <Button x:Name="ToggleBackgroundButton"
                                        Width="20"
                                        Height="30"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White"
                                        FontSize="16"
                                        Click="ToggleBackgroundButton_Click"
                                        Margin="12,5,0,0"
                                        FocusVisualStyle="{x:Null}">
                                        <Image x:Name="BackgroundToggleButtonImage"
                                                Source="images/show-background.png"
                                                Width="15"
                                                Height="12"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"
                                                />
                                </Button>
                        </StackPanel>

                        <StackPanel Grid.Column="1"
                                        Orientation="Horizontal"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Top">
                                <Button x:Name="LogoutButton"
                                        Width="20"
                                        Height="30"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White"
                                        FontSize="16"
                                        FontWeight="Normal"
                                        Click="LogoutButton_Click"
                                        Margin="5,5,0,0"
                                        Visibility="{Binding ElementName=TablesPanel, Path=Visibility}">
                                        <Image x:Name="Logout"
                                                Source="images/exit.png"
                                                Width="14"
                                                Height="13"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"/>
                                </Button>
                                <Button x:Name="BackButton"
                                        Width="20"
                                        Height="30"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        FontSize="16"
                                        Foreground="White"
                                        FontWeight="Bold"
                                        Click="BackButton_Click"
                                        Margin="0,5,0,0"
                                        Visibility="{Binding ElementName=TablesScrollViewer, Path=Visibility}">
                                <Image x:Name="BackButtonImage"
                                                Source="images/back.png"
                                                Width="15"
                                                Height="10"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"
                                                />
                                </Button>

                                <Button x:Name="BackFromEditButton"
                                        Width="20"
                                        Height="30"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        FontSize="16"
                                        Foreground="White"
                                        FontWeight="Bold"
                                        Click="BackFromEditButton_Click"
                                        Margin="0,5,0,0"
                                        Visibility="{Binding ElementName=EditCastleScroll, Path=Visibility}">
                                <Image x:Name="BackFromEditButtonImage"
                                                Source="images/back.png"
                                                Width="15"
                                                Height="10"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"
                                                />
                                </Button>
                                
                                <Button x:Name="ToggleCollapseButton"
                                        Width="20"
                                        Height="30"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Margin="0,4,0,0"
                                        Click="ToggleCollapseButton_Click">
                                        <Image x:Name="ToggleCollapseButtonImage"
                                                Source="images/reveal.png"
                                                Width="13"
                                                Height="13"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"
                                                />
                                                
                                </Button>
                                
                                <Button x:Name="CloseButton"
                                        Width="20"
                                        FontSize="16"
                                        Height="30"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White"
                                        Click="CloseButton_Click"
                                        Margin="0,4,10,0">
                                <Image x:Name="CloseButtonImage"
                                                Source="images/close.png"
                                                Width="14"
                                                Height="14"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"
                                                RenderOptions.BitmapScalingMode="HighQuality"/>
                                </Button>
                        </StackPanel>
                        </Grid>

                <StackPanel Orientation="Horizontal"
                            Grid.Row="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Margin="0,0,10,0"
                            Visibility="{Binding IsSavedLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Ellipse x:Name="Dot1"
                                 Width="10"
                                 Height="10"
                                 Fill="#A9B8D5"
                                 Margin="2"/>
                        <Ellipse x:Name="Dot2"
                                 Width="10"
                                 Height="10"
                                 Fill="#7589B3"
                                 Margin="2"/>
                        <Ellipse x:Name="Dot3"
                                 Width="10"
                                 Height="10"
                                 Fill="#415B91"
                                 Margin="2"/>
                </StackPanel>

                <StackPanel x:Name="LoginPanel"
                            Visibility="{Binding IsSavedLoading, Converter={StaticResource InvertedBooleanToVisibilityConverter}}"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Height="300"
                            Width="300"
                            Margin="0,30,0,0">
                        <StackPanel x:Name="EmailLoginPanel"
                                    Visibility="Visible">
                                <Label Content="Email"
                                       FontSize="14"
                                       HorizontalAlignment="Center"
                                       Foreground="White"
                                       FontWeight="Bold"
                                       Margin="0,10,0,0"/>
                                <TextBox x:Name="EmailTextBox"
                                         FontSize="14"
                                         Width="200"
                                         Margin="0,2,0,10"
                                         Foreground="White"
                                         Background="#7a8ebf"/>
                                <Label Content="Пароль"
                                       FontSize="14"
                                       HorizontalAlignment="Center"
                                       Foreground="White"
                                       FontWeight="Bold"/>
                                <PasswordBox x:Name="PasswordBox"
                                        Style="{StaticResource PasswordBox}"
                                             FontSize="14"
                                             Width="200"
                                             Margin="0,2,0,10"
                                             />
                                <Button x:Name="LoginButton"
                                        FontSize="14"
                                        Content="Войти"
                                        Click="LoginButton_Click"
                                        Width="100"
                                        Margin="0,5,0,5"
                                        FontWeight="Bold"
                                        Background="#1f70f2"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Padding="20,5"/>
                                <Button Content="Вход по токену"
                                        FontSize="14"
                                        Click="SwitchToTokenLogin"
                                        Width="150"
                                        Margin="0,5,0,5"
                                        FontWeight="Bold"
                                        Foreground="White"
                                        Background="Transparent"
                                        BorderThickness="0"/>
                        </StackPanel>

                        <StackPanel x:Name="TokenLoginPanel"
                                    Visibility="Collapsed">
                                <Label Content="Вставьте ваш токен:"
                                       FontSize="14"
                                       HorizontalAlignment="Center"
                                       Foreground="White"
                                       FontWeight="Bold"
                                       Margin="0,10,0,0"/>
                                <TextBox x:Name="TokenTextBox"
                                         FontSize="14"
                                         Foreground="White"
                                         Background="#7a8ebf"
                                         Width="200"
                                         Margin="0,2,0,10"/>
                                <Button Content="Войти"
                                        FontSize="14"
                                        x:Name="TokenLoginButton"
                                        Click="TokenLoginButton_Click"
                                        Width="100"
                                        Margin="0,5,0,5"
                                        FontWeight="Bold"
                                        Background="#1f70f2"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Padding="20,5"/>
                                <Button Content="Вход по паролю"
                                        FontSize="14"
                                        Click="SwitchToEmailLogin"
                                        Width="150"
                                        Margin="0,5,0,5"
                                        FontWeight="Bold"
                                        Foreground="White"
                                        Background="Transparent"
                                        BorderThickness="0"/>
                        </StackPanel>

                        <TextBlock x:Name="StatusTextBlock"
                                   Margin="0,10,0,0"
                                   TextAlignment="Center"
                                   FontWeight="Bold"
                                   FontSize="14"
                                   Foreground="#eac988"
                                   Width="250"
                                   Height="60"
                                   TextWrapping="WrapWithOverflow"/>
                </StackPanel>

                <Grid x:Name="TablesPanel"
                      Grid.Row="1"
                      Visibility="Collapsed"
                      Margin="8,0,8,8">
                        <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <DataGrid x:Name="TablesDataGrid"
                                  Grid.Row="1"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  Background="Transparent"
                                  Foreground="White"
                                  RowBackground="Transparent"
                                  FontSize="16"
                                  AlternatingRowBackground="Transparent"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="None"
                                  HorizontalGridLinesBrush="#80555555"
                                  VerticalGridLinesBrush="#80555555"
                                  CanUserSortColumns="False"
                                  PreviewMouseWheel="DataGrid_PreviewMouseWheel"
                                  PreviewMouseLeftButtonUp="TablesDataGrid_PreviewMouseLeftButtonDown">
                                <DataGrid.Columns>
                                        <DataGridTextColumn Header="Выберите таблицу"
                                                            Binding="{Binding name}"
                                                            Width="*"/>
                                </DataGrid.Columns>
                        </DataGrid>
                </Grid>

                <Grid x:Name="MainContent"
                      Grid.Row="1"
                      Margin="8,0,8,8">
                        <Grid.Style>
                                <Style TargetType="Grid">
                                        <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsContentCollapsed, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                        </Style.Triggers>
                                </Style>
                        </Grid.Style>
                        <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <ScrollViewer Grid.Row="0"
                                      Visibility="Collapsed"
                                      x:Name="TablesScrollViewer"
                                      VerticalScrollBarVisibility="Auto"
                                      PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                <DataGrid x:Name="CastlesDataGrid"
                                          AutoGenerateColumns="False"
                                          IsReadOnly="True"
                                          RowHeight="30"
                                          Background="Transparent"
                                          FontSize="16"
                                          Foreground="White"
                                          RowBackground="Transparent"
                                          AlternatingRowBackground="Transparent"
                                          CanUserAddRows="False"
                                          CanUserDeleteRows="False"
                                          CanUserReorderColumns="True"
                                          HeadersVisibility="Column"
                                          GridLinesVisibility="None"
                                          HorizontalGridLinesBrush="#80555555"
                                          VerticalGridLinesBrush="#80555555"
                                          CanUserSortColumns="True"
                                          MouseLeftButtonUp="CastlesDataGrid_MouseLeftButtonUp"
                                          Sorting="CastlesDataGrid_Sorting"
                                          >
                                        <DataGrid.Resources>
                                                <Style x:Key="{x:Static DataGrid.FocusVisualStyleProperty}" TargetType="Control"/>
                                                <Style TargetType="DataGridCell">
                                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                                        <Setter Property="BorderThickness" Value="0"/>
                                                        <Style.Triggers>
                                                                <Trigger Property="IsSelected" Value="True">
                                                                        <Setter Property="Background" Value="Transparent"/>
                                                                        <Setter Property="Foreground" Value="White"/>
                                                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                                                </Trigger>
                                                        </Style.Triggers>
                                                </Style>
                                        </DataGrid.Resources>
                                        <DataGrid.RowStyle>
                                                <Style TargetType="DataGridRow">
                                                        <Style.Triggers>
                                                                <DataTrigger Binding="{Binding WhiteTime}"
                                                                             Value="-">
                                                                        <Setter Property="Foreground"
                                                                                Value="LightSlateGray"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding WhiteTime}"
                                                                             Value="N/A">
                                                                        <Setter Property="Foreground"
                                                                                Value="LightSlateGray"/>
                                                                </DataTrigger>
                                                        </Style.Triggers>
                                                </Style>
                                        </DataGrid.RowStyle>
                                        <DataGrid.Columns>
                                                <DataGridTemplateColumn Header=""
                                                                        Width="30"
                                                                        MinWidth="30">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                        <Border Background="{Binding StatusColor}"
                                                                                Width="20"
                                                                                Height="20"
                                                                                CornerRadius="3"
                                                                                HorizontalAlignment="Center"
                                                                                VerticalAlignment="Center"/>
                                                                </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="Замок"
                                                                    Binding="{Binding nameRu}"
                                                                    SortMemberPath="nameRu"
                                                                    Width="120"
                                                                    MinWidth="120">
                                                        <DataGridTextColumn.ElementStyle>
                                                                <Style TargetType="TextBlock">
                                                                        <Setter Property="VerticalAlignment"
                                                                                Value="Center"/>
                                                                        <Setter Property="FontWeight"
                                                                                Value="Bold"/>
                                                                        <Setter Property="Margin"
                                                                                Value="7,0"/>
                                                                        <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding WhiteTime}"
                                                                                             Value="-">
                                                                                        <Setter Property="FontWeight"
                                                                                                Value="Normal"/>
                                                                                </DataTrigger>
                                                                                <DataTrigger Binding="{Binding WhiteTime}"
                                                                                             Value="N/A">
                                                                                        <Setter Property="FontWeight"
                                                                                                Value="Normal"/>
                                                                                </DataTrigger>
                                                                        </Style.Triggers>
                                                                </Style>
                                                        </DataGridTextColumn.ElementStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Лить"
                                                                    Binding="{Binding WhiteTimeExact, StringFormat='HH:mm'}"
                                                                    Width="Auto"
                                                                    MinWidth="70">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                                            <Setter Property="Margin" Value="7,0"/>
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                </DataGridTextColumn>
                                
                                                <DataGridTemplateColumn Header="Через"
                                                                        Width="Auto"
                                                                        MinWidth="70"
                                                                        SortMemberPath="WhiteTimeExact">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                        <TextBlock Text="{Binding WhiteTime}"
                                                                                   FontWeight="Bold"
                                                                                   VerticalAlignment="Center"
                                                                                   HorizontalAlignment="Left">
                                                                                <TextBlock.Style>
                                                                                        <Style TargetType="TextBlock">
                                                                                                <Setter Property="FontWeight"
                                                                                                        Value="Bold"/>
                                                                                                <Setter Property="Margin"
                                                                                                        Value="7,0"/>
                                                                                                <Setter Property="VerticalAlignment"
                                                                                                        Value="Center"/>
                                                                                                <Style.Triggers>
                                                                                                        <DataTrigger Binding="{Binding WhiteTime}"
                                                                                                                     Value="-">
                                                                                                                <Setter Property="FontWeight"
                                                                                                                        Value="Normal"/>
                                                                                                        </DataTrigger>
                                                                                                        <DataTrigger Binding="{Binding WhiteTime}"
                                                                                                                     Value="N/A">
                                                                                                                <Setter Property="FontWeight"
                                                                                                                        Value="Normal"/>
                                                                                                        </DataTrigger>
                                                                                                </Style.Triggers>
                                                                                        </Style>
                                                                                </TextBlock.Style>
                                                                        </TextBlock>
                                                                </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="СВ"
                                                                    Binding="{Binding fillingSpheretime}"
                                                                    Width="Auto"
                                                                    MinWidth="50"
                                                                    SortMemberPath="fillingSpheretime">
                                                        <DataGridTextColumn.ElementStyle>
                                                                <Style TargetType="TextBlock">
                                                                        <Setter Property="Margin"
                                                                                Value="7,0"/>
                                                                        <Setter Property="VerticalAlignment"
                                                                                Value="Center"/>
                                                                </Style>
                                                        </DataGridTextColumn.ElementStyle>
                                                </DataGridTextColumn>
                                                <DataGridTemplateColumn Header="Спад"
                                                                        Width="Auto"
                                                                        MinWidth="70"
                                                                        SortMemberPath="RedTimeExact">
                                                        <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                        <TextBlock Text="{Binding RedTime}"
                                                                                   FontWeight="Bold"
                                                                                   VerticalAlignment="Center"
                                                                                   HorizontalAlignment="Left">
                                                                                <TextBlock.Style>
                                                                                        <Style TargetType="TextBlock">
                                                                                                <Setter Property="FontWeight"
                                                                                                        Value="Bold"/>
                                                                                                <Setter Property="Margin"
                                                                                                        Value="7,0"/>
                                                                                                <Setter Property="VerticalAlignment"
                                                                                                        Value="Center"/>
                                                                                                <Style.Triggers>
                                                                                                        <DataTrigger Binding="{Binding RedTime}"
                                                                                                                     Value="-">
                                                                                                                <Setter Property="FontWeight"
                                                                                                                        Value="Normal"/>
                                                                                                        </DataTrigger>
                                                                                                        <DataTrigger Binding="{Binding RedTime}"
                                                                                                                     Value="N/A">
                                                                                                                <Setter Property="FontWeight"
                                                                                                                        Value="Normal"/>
                                                                                                        </DataTrigger>
                                                                                                </Style.Triggers>
                                                                                        </Style>
                                                                                </TextBlock.Style>
                                                                        </TextBlock>
                                                                </DataTemplate>
                                                        </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                                <DataGridTextColumn Header="Комментарий"
                                                                    Binding="{Binding commentary}"
                                                                    Width="Auto"
                                                                    MinWidth="150">
                                                    <DataGridTextColumn.ElementStyle>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                                            <Setter Property="HorizontalAlignment" Value="Left"/>
                                                            <Setter Property="Margin" Value="7,0"/>
                                                        </Style>
                                                    </DataGridTextColumn.ElementStyle>
                                                </DataGridTextColumn>
                                                <DataGridTextColumn Header="Клан"
                                                                    Binding="{Binding OwnerClanName}"
                                                                    Width="Auto"
                                                                    MinWidth="70"
                                                                    SortMemberPath="OwnerClanName">
                                                        <DataGridTextColumn.ElementStyle>
                                                                <Style TargetType="TextBlock">
                                                                        <Setter Property="Margin"
                                                                                Value="7,0"/>
                                                                        <Setter Property="VerticalAlignment"
                                                                                Value="Center"/>
                                                                </Style>
                                                        </DataGridTextColumn.ElementStyle>
                                                </DataGridTextColumn>
                                                
                                        </DataGrid.Columns>
                                </DataGrid>
                        </ScrollViewer>

                        <StackPanel x:Name="TimeButtonsPanel"
                                Grid.Row="1"
                                Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                Margin="0,4,0,8">
                                <StackPanel.Style>
                                        <Style TargetType="{x:Type StackPanel}">
                                        <Setter Property="Visibility"
                                                Value="Hidden" />
                                        <Style.Triggers>
                                                <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                        <Condition Binding="{Binding ElementName=TablesScrollViewer, Path=Visibility}"
                                                                Value="Visible" />
                                                        <Condition Binding="{Binding ElementName=MainFrame, Path=Opacity}"
                                                                Value="1.0" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Visibility"
                                                        Value="Visible" />
                                                </MultiDataTrigger>
                                        </Style.Triggers>
                                        </Style>
                                        </StackPanel.Style>

                                <Button Margin="3,0,6,0"
                                        Click="SelectAllLocks_Click"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Width="32"
                                        Height="24"
                                        VerticalContentAlignment="Center"
                                        HorizontalContentAlignment="Center">
                                        <Image x:Name="CancelCastles"
                                                Source="images/cancel.png"
                                                Width="22"
                                                Height="14"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"/>
                                </Button>

                                <Button Content="15"
                                        Margin="3,0"
                                        Tag="15"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />
                                <Button Content="30"
                                        Margin="3,0"
                                        Tag="30"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />
                                <Button Content="45"
                                        Margin="3,0"
                                        Tag="45"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />
                                <Button Content="60"
                                        Margin="3,0"
                                        Tag="60"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />
                                <Button Content="75"
                                        Margin="3,0"
                                        Tag="75"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />
                                <Button Content="90"
                                        Margin="3,0"
                                        Tag="90"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />
                                <Button Content="120"
                                        Margin="3,0"
                                        Tag="120"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />
                                <Button Content="250"
                                        Margin="3,0"
                                        Tag="250"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />
                                <Button Content="350"
                                        Margin="3,0"
                                        Tag="350"
                                        Click="TimeButton_Click"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Foreground="White" />

                                <Button Margin="6,0,3,0"
                                        Click="RemoveAllLocks_Click"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        Width="32"
                                        Height="24"
                                        VerticalContentAlignment="Center"
                                        HorizontalContentAlignment="Center">
                                                <Image x:Name="CheckCastles"
                                                Source="images/check.png"
                                                Width="24"
                                                Height="16"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"/>
                                </Button>
                        </StackPanel>

                        <ScrollViewer Grid.Row="1"
                                      VerticalScrollBarVisibility="Auto"
                                      x:Name="EditCastleScroll"
                                      Visibility="Collapsed">
                                <StackPanel x:Name="EditCastleForm"
                                            VerticalAlignment="Top">
                                        <StackPanel.Resources>
                                                <Style TargetType="TextBox"
                                                       BasedOn="{StaticResource BaseTextBoxStyle}">
                                                        <Setter Property="HorizontalAlignment"
                                                                Value="Stretch"/>
                                                        <Setter Property="MaxWidth"
                                                                Value="400"/>
                                                        <Setter Property="CaretBrush" Value="White"/>
                                                </Style>
                                                <Style TargetType="TextBlock"
                                                       BasedOn="{StaticResource BaseTextBlockStyle}">
                                                        <Setter Property="HorizontalAlignment"
                                                                Value="Stretch"/>
                                                        <Setter Property="MaxWidth"
                                                                Value="400"/>
                                                </Style>
                                                <Style TargetType="ComboBox"
                                                       BasedOn="{StaticResource BaseComboBoxStyle}">
                                                        <Setter Property="HorizontalAlignment"
                                                                Value="Stretch"/>
                                                        <Setter Property="MaxWidth"
                                                                Value="400"/>
                                                </Style>
                                        </StackPanel.Resources>
                                        <TextBlock x:Name="CastleNameTextBlock"
                                                   Margin="0,0,0,0"
                                                   HorizontalAlignment="Center"
                                                   FontSize="18"/>
                                        <StackPanel Margin="8"
                                                    MaxWidth="400">
                                                <Grid Margin="0,5">
                                                        <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Время*"
                                                                   Grid.Column="0"
                                                                   VerticalAlignment="Center"
                                                                   Margin="0,0,10,0"/>
                                                        <TextBox Name="FillingTimeTextBox"
                                                                 Grid.Column="1"
                                                                 TabIndex="1"
                                                                 GotFocus="TextBox_GotFocus"
                                                                 LostFocus="FillingTimeTextBox_LostFocus"/>
                                                </Grid>
                                                <Grid Margin="0,5">
                                                        <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Дата*"
                                                                   Grid.Column="0"
                                                                   VerticalAlignment="Center"
                                                                   Margin="0,0,10,0"/>
                                                        <ComboBox Name="FillingDateComboBox"
                                                                TabIndex="2"
                                                                  Grid.Column="1"
                                                                  VerticalAlignment="Center"/>
                                                </Grid>
                                                <Grid Margin="0,5">
                                                        <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Лива*"
                                                                   Grid.Column="0"
                                                                   VerticalAlignment="Center"
                                                                   Margin="0,0,10,0"/>
                                                        <ComboBox x:Name="FillingLvlComboBox"
                                                                TabIndex="3"
                                                                  Grid.Column="1"
                                                                  VerticalAlignment="Center"/>
                                                </Grid>
                                                <Grid Margin="0,5">
                                                        <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="СВ"
                                                                   Grid.Column="0"
                                                                   VerticalAlignment="Center"
                                                                   Margin="0,0,10,0"/>
                                                        <TextBox x:Name="FillingSpheretimeTextBox"
                                                                TabIndex="4"
                                                                 Grid.Column="1"
                                                                 GotFocus="TextBox_GotFocus"
                                                                 LostFocus="FillingSpheretimeTextBox_LostFocus"
                                                                 VerticalAlignment="Center"/>
                                                </Grid>
                                                <Grid Margin="0,5">
                                                        <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Клан*"
                                                                   Grid.Column="0"
                                                                   VerticalAlignment="Center"
                                                                   Margin="0,0,10,0"/>
                                                        <ComboBox x:Name="ClanComboBox"
                                                                  Grid.Column="1"
                                                                  TabIndex="5"
                                                                  VerticalAlignment="Center"/>
                                                </Grid>
                                                <Grid Margin="0,5">
                                                        <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="70"/>
                                                                <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Коммент"
                                                                   Grid.Column="0"
                                                                   VerticalAlignment="Center"
                                                                   Margin="0,0,10,0"/>
                                                        <TextBox x:Name="CommentaryTextBox"
                                                                 Grid.Column="1"
                                                                 TabIndex="6"
                                                                 GotFocus="TextBox_GotFocus"
                                                                 VerticalAlignment="Center"/>
                                                </Grid>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center">
                                                <Button x:Name="CancelEditButton"
                                                        TabIndex="7"
                                                        Width="40"
                                                        Height="30"
                                                        Margin="0,5,10,0"
                                                        Background="Transparent"
                                                        BorderThickness="0"
                                                        BorderBrush="Transparent"
                                                        Cursor="Hand"
                                                        Click="BackFromEditButton_Click">
                                                        <Image Source="images/cancel.png"
                                                        Width="20"
                                                        Height="20"
                                                        VerticalAlignment="Center"
                                                        HorizontalAlignment="Center"/>
                                                </Button>
                                                <Button x:Name="SaveCastleButton"
                                                        TabIndex="8"
                                                        Width="40"
                                                        Height="30"
                                                        Margin="10,5,0,0"
                                                        Background="Transparent"
                                                        BorderThickness="0"
                                                        BorderBrush="Transparent"
                                                        Cursor="Hand"
                                                        Click="SaveCastleButton_Click">
                                                        <Image Source="images/check.png"
                                                        Width="24"
                                                        Height="24"
                                                        VerticalAlignment="Center"
                                                        HorizontalAlignment="Center"/>
                                                </Button>
                                        </StackPanel>
                                        <TextBlock x:Name="EditErrorTextBlock"
                                                   FontWeight="Normal"
                                                   Foreground="#eac988"
                                                   Margin="0,10,0,0"
                                                   TextAlignment="Center"
                                                   Visibility="Collapsed"/>
                                </StackPanel>
                        </ScrollViewer>
                </Grid>
        </Grid>
        </Grid>
</Window>